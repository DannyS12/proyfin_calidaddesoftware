<!-- Encabezado tipo Dashboard -->
<div class="d-flex align-items-center justify-content-between mb-4">
  <div>
    <h1 class="h3 mb-1">Crear Usuario</h1>
    <p class="text-muted mb-0">Registra un nuevo usuario del sistema</p>
  </div>
  <div>
    <a href="/verUsuario" class="btn btn-outline-secondary">
      <i class="bi bi-arrow-left"></i> Volver a la lista
    </a>
  </div>
</div>

<!-- Formulario -->
<div class="card shadow-sm">
  <div class="card-body">
    <form id="usuarioForm" action="/saveUsuario" method="POST" novalidate>
      <div class="row g-3">
        <div class="col-12 col-md-6">
          <label for="NombreUsuario" class="form-label">Nombre de Usuario</label>
          <input
            type="text"
            class="form-control"
            id="NombreUsuario"
            name="NombreUsuario"
            required
            minlength="3"
            maxlength="30"
            pattern="^[A-Za-z0-9_]+$"
            placeholder="Ej. jperez_01"
          />
          <div class="invalid-feedback">
            Nombre de usuario válido: 3-30 caracteres, letras, números y guion bajo.
          </div>
        </div>

        <div class="col-12 col-md-6">
          <label for="Contrasena" class="form-label">Contraseña</label>
          <input
            type="password"
            class="form-control"
            id="Contrasena"
            name="Contrasena"
            required
            minlength="6"
            maxlength="50"
            placeholder="Mínimo 6 caracteres"
          />
          <div class="invalid-feedback">La contraseña debe tener entre 6 y 50 caracteres.</div>
        </div>

        <div class="col-12 col-md-4">
          <label for="Rol" class="form-label">Rol</label>
          <select id="Rol" name="Rol" class="form-select" required>
            <option value="" disabled selected>Selecciona un rol</option>
            <option value="Administrador">Administrador</option>
            <option value="Vendedor">Vendedor</option>
            <option value="Cajero">Cajero</option>
            <option value="Inventario">Inventario</option>
          </select>
          <div class="invalid-feedback">
            Selecciona un rol.
          </div>
        </div>

        <div class="col-12 col-md-4">
          <label for="Nombre" class="form-label">Nombre</label>
          <input
            type="text"
            class="form-control"
            id="Nombre"
            name="Nombre"
            required
            minlength="3"
            maxlength="50"
            pattern="^[A-Za-zÁÉÍÓÚáéíóúÑñ\s]+$"
            placeholder="Ej. Juan"
          />
          <div class="invalid-feedback">Nombre válido: solo letras y espacios, 3-50 caracteres.</div>
        </div>

        <div class="col-12 col-md-4">
          <label for="Apellido" class="form-label">Apellido</label>
          <input
            type="text"
            class="form-control"
            id="Apellido"
            name="Apellido"
            required
            minlength="3"
            maxlength="50"
            pattern="^[A-Za-zÁÉÍÓÚáéíóúÑñ\s]+$"
            placeholder="Ej. Pérez"
          />
          <div class="invalid-feedback">Apellido válido: solo letras y espacios, 3-50 caracteres.</div>
        </div>

        <div class="col-12 col-md-6">
          <label for="Email" class="form-label">Email</label>
          <input
            type="email"
            class="form-control"
            id="Email"
            name="Email"
            required
            placeholder="correo@dominio.com"
          />
          <div class="invalid-feedback">Ingresa un correo electrónico válido.</div>
        </div>

        <div class="col-12 col-md-6">
          <label for="Telefono" class="form-label">Teléfono</label>
          <input
            type="text"
            class="form-control"
            id="Telefono"
            name="Telefono"
            required
            pattern="^\d{8}$"
            maxlength="8"
            inputmode="numeric"
            placeholder="8 dígitos"
          />
          <div class="invalid-feedback">Teléfono válido: exactamente 8 dígitos numéricos.</div>
        </div>
      </div>

      <div class="d-flex gap-2 mt-4">
        <button type="submit" class="btn btn-success">
          <i class="bi bi-save me-1"></i> Guardar
        </button>
        <a href="/verUsuario" class="btn btn-secondary">Cancelar</a>
      </div>
    </form>
  </div>
</div>

<!-- Validación Bootstrap y filtros -->
<script>
  (function () {
    'use strict';
    const form = document.getElementById('usuarioForm');
    const tel = document.getElementById('Telefono');

    // Filtro: solo números para teléfono
    tel.addEventListener('input', () => {
      tel.value = tel.value.replace(/\D/g, '');
    });

    // Validación Bootstrap
    form.addEventListener('submit', function (event) {
      if (!form.checkValidity()) {
        event.preventDefault();
        event.stopPropagation();
      }
      form.classList.add('was-validated');
    }, false);
  })();
</script>